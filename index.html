<html>
<body onload="/*launchNow1(),*/launchNow()">
<link rel="stylesheet" href="style.css">


<script src="./WebDirt/WebDirt-packed.js"></script> <!-- import WebDirt JS library -->
<!--

<script src="static/js/p5.min.js">  </script> 
<script src="static/js/newdollzjs.js"> </script> 


<script defer src=https://cdn.JsDelivr.net/npm/p5@0.7.2></script>
<script defer src=https://Unpkg.com/p5@0.7.2/lib/addons/p5.dom.min.js></script>
-->

<script type="module">
import {launch, launchDirt , main, printToConsole, renderStandalone, parse } from './index.js'

function launchNow(){
	window._engineRecord = launch();
	window._webDirt = launchDirt();
	render();
}

function doEvaluate() {
	var t = document.getElementById("code").value;
	var x = parse(_engineRecord)(t)();
	document.getElementById('status').textContent = x;
}

function stop() {
	var x = parse(_engineRecord)("")();
	document.getElementById('status').textContent = x;
}

function render(){
	renderStandalone(_engineRecord)(_webDirt)();
	setTimeout(render,200);
}

window.launchNow = launchNow;
window.doEvaluate = doEvaluate;
window.render = render;
window.stop = stop;

	
// event to start audio on ios
window.addEventListener('touchstart', function() {

	// create empty buffer
	var buffer = myContext.createBuffer(1, 1, 22050);
	var source = myContext.createBufferSource();
	source.buffer = buffer;

	// connect to output (your speakers)
	source.connect(myContext.destination);

	// play the file
	source.noteOn(0);

}, false);
	
</script>


<button id="advance_text" onclick="advanceMessage()">Next</button>
<div> <canvas ><script src="static/js/newdollzjs.js"> </script>  </canvas></div>
<div id=codeBlock>

	<h1>Shift</h1>
	<h2> a live coding language for classrooms </h2>

<textarea id="code" rows="4" cols="50" onkeydown="if(event.keyCode===9){var v=this.value,s=this.selectionStart,e=this.selectionEnd;this.value=v.substring(0, s)+'\t'+v.substring(e);this.selectionStart=this.selectionEnd=s+1;return false;} " >y=0

every 1.5
	y = 0
	i = [0 4 8]


every 0.5
	play.Piano:i:y[70,0,0]
	y = y +1

every 3 
	i = [0 5 7]

every 0.75
	play.Piano:(i:y)-1[70,0,100]

</textarea>

<script>

var script1 = `y=0
every 1.5
	y = 0
	i = [0 4 8]
every 0.5
	play.Piano:i:y[70,0,0]
	y = y +1
every 3 
	i = [0 5 7]
every 0.75
	play.Piano:(i:y)-1[70,0,100]
`
   
var script2 = `change = 6
time = 1/1.3
every 0.75 / time
	y = 0
	i = [0 4 8]
every 1 / time
	vol = 0
	change = change + 1
every 0.5/ time
	play.snare:4[vol]
	vol = vol + 60
every 0.25/ time
	play.teringherrie:o*change[50,0,pan]
	y = y +1
 	o = i:y
	pan = random. 40 70
every 1.5 / time
	i = [0 5 7]
every 0.75/ time
	play.HARDBASS:(o*change)-1 [70,0,40]	
	play.HARDBASS:(o*change)-2 [70,0,70]
every 3/ time
	y = 0
	i = [0 4 8]
every 1/ time
	play.k2:2[80,(-4),50]
every 2/ time
	play.hi*change [50,0,100]
	y = y +1
 	o = i:y
every 6 / time
	i = [0 5 7]
	change = 0
every 0.75*2/ time
	play.hi:(o*change)-1[50,0,0]
` 
var script3 =`i=3
every y
	x = random. 1 3
	y = x / 3
	
	play.hi[70,x,p]
	play.hi:1[70,x+4,o]
every 0.1
	play.pingu:x-1[60,x,p]
every 0.2 
	p = random. 0 100
	o = random. 0 100
	d = random. 0 100
every 0.05
	play.Organ1[50,0+i,p]
	play.Organ1[50,7+i,o]
	play.Organ2[50,12+i,d]
every 16
	i= x
`
var textarea = document.getElementById("code");
var messages = [ script1, script2, script3 ];
var currMesg = 0;

function advanceMessage() {
    textarea.value = messages[ currMesg++ % messages.length ];
}

advanceMessage();
</script>

</div>
<div id=buttonPlace>
<button onclick="doEvaluate()"> evaluate </button> 
<button onclick="stop()"> Stop! :-) </button> 

<div id="status"> </div>
</div>
<!--
<textarea id="code1" name="w3review" rows="4" cols="50" onkeydown="if(event.keyCode===9){var v=this.value,s=this.selectionStart,e=this.selectionEnd;this.value=v.substring(0, s)+'\t'+v.substring(e);this.selectionStart=this.selectionEnd=s+1;return false;}" >
-->
</body>
</html>
